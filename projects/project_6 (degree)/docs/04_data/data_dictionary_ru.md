# Словарь данных (Data Dictionary) - Русские обозначения

## Контекст

Написан словарь данных с описанием атрибутов сущностей и типов данных, используемых в приложении Stets Home. Все обозначения представлены на русском языке для удобства использования.

## Структура словаря

| Элемент данных | Описание | Состав или тип данных | Длина | Значения |
|---|---|---|---|---|
| **Пользователь** | Данные пользователя, указанные при регистрации | Электронная почта<br>+ Имя пользователя<br>+ Пароль пользователя |  |  |
| Электронная почта | Адрес электронной почты пользователя, предоставленный при регистрации | Символьно-числовое значение | 255 | Должен содержать символ @, уникальный в системе |
| Имя пользователя | Имя пользователя, указанное при регистрации | Символьное значение | 100 | Минимум 2 символа |
| Пароль пользователя | Пароль пользователя, предоставленный при регистрации. Используется для аутентификации. Хранится в виде bcrypt хэша | Символьно-числовое значение | 60 | Длина пароля: 8-16 символов. Должен содержать минимум 1 строчную и 1 прописную букву латинского алфавита. Хранится как bcrypt hash |
| Код пользователя | Синтетический первичный ключ пользователя | Целое и положительное | 11 | AUTO_INCREMENT, NOT NULL |
| Дата и время регистрации | Дата и время регистрации пользователя | Дата и время | - | Формат: YYYY-MM-DD HH:MM:SS |
| Дата и время последнего обновления | Дата и время последнего обновления данных пользователя | Дата и время | - | Формат: YYYY-MM-DD HH:MM:SS |
| **Дом** | Дом для управления | Код дома<br>+ Название дома<br>+ 1:10 {дом}<br>+ 1:10 {комнат}<br>+ 1:10 {сценариев}<br>+ 1:100 {устройств} |  |  |
| Код дома | Синтетический первичный ключ дома | Целое и положительное | 11 | AUTO_INCREMENT, NOT NULL |
| Название дома | Название дома, задается пользователем | Символьное значение | 100 | По умолчанию "Мой дом" |
| Дата и время создания дома | Дата и время создания дома | Дата и время | - | Формат: YYYY-MM-DD HH:MM:SS |
| **Доступ к дому** | Связывает пользователей с домами, определяя уровень доступа | Электронная почта<br>+ Код дома<br>+ Уровень доступа |  |  |
| Код связи | Синтетический первичный ключ связи пользователя и дома | Целое и положительное | 11 | AUTO_INCREMENT, NOT NULL |
| Код пользователя (в доступе) | Ссылка на пользователя | Целое и положительное | 11 | Внешний ключ к таблице Пользователь |
| Код дома (в доступе) | Ссылка на дом | Целое и положительное | 11 | Внешний ключ к таблице Дом |
| Уровень доступа | Уровень прав пользователя в доме | Символьное значение | - | "owner" (владелец), "member" (участник). По умолчанию "member" |
| Дата и время добавления к дому | Дата и время добавления пользователя к дому | Дата и время | - | Формат: YYYY-MM-DD HH:MM:SS |
| **Комната** | Помещения различного типа | Код комнаты<br>+ Код дома<br>+ Код типа комнаты<br>+ Название комнаты |  |  |
| Код комнаты | Синтетический первичный ключ комнаты | Целое и положительное | 11 | AUTO_INCREMENT, NOT NULL |
| Код дома (в комнате) | Ссылка на дом, к которому относится комната | Целое и положительное | 11 | Внешний ключ к таблице Дом, NOT NULL |
| Код типа комнаты | Синтетический первичный ключ типа комнаты | Целое и положительное | 11 | Внешний ключ к таблице Тип комнаты, NOT NULL |
| Название комнаты | Название комнаты, предлагаемое системой на основе выбранного типа комнаты "Спальня", или заданное пользователем вручную | Символьно-числовое значение | 100 | Тип комнаты + цифра при повторе, или любое название. Минимум 1 символ. Уникально в рамках дома |
| Тип комнаты (значение) | Значение типа комнаты | Символьное значение | - | "living_room" (гостиная), "bedroom" (спальня), "kitchen" (кухня), "bathroom" (ванная), "hallway" (прихожая), "corridor" (коридор), "other" (другое). По умолчанию "other" |
| Дата и время создания комнаты | Дата и время создания комнаты | Дата и время | - | Формат: YYYY-MM-DD HH:MM:SS |
| **Тип комнаты** | Справочник типов комнат с иконками | Код типа комнаты<br>+ Название типа комнаты<br>+ Иллюстрация комнаты |  |  |
| Код типа комнаты | Синтетический первичный ключ типа комнаты | Целое и положительное | 11 | AUTO_INCREMENT, NOT NULL |
| Название типа комнаты | Тип комнаты (например, "Спальня", "Кухня") | Символьное значение | 50 | Уникальное в системе. Примеры: "bedroom", "kitchen", "bathroom" |
| Иллюстрация комнаты | Изображение со значением типа комнаты | Файл (URL) | 255 | Валидный URL, пример: "/icons/bedroom.svg" |
| Категория иконки | Категория иконки в справочнике | Символьное значение | 30 | "room_type" (тип комнаты), "device_type" (тип устройства) |
| **Устройство** | Устройства пользователя добавленные в приложение умного дома | ID устройства<br>+ Код модели устройства<br>+ Код дома<br>+ Код комнаты<br>+ Название устройства<br>+ Статус устройства<br>+ Статус режима энергосбережения<br>+ Цвет<br>+ Яркость |  |  |
| Код устройства | Синтетический первичный ключ устройства | Целое и положительное | 11 | AUTO_INCREMENT, NOT NULL |
| ID устройства | Уникальный 12-значный код для идентификации устройства | Числовое значение | 12 | Только цифры (0-9), уникальный в системе. Пример: "123456789012" |
| Код модели устройства | Уникальный код модели устройства | Целое и положительное | 11 | Внешний ключ к таблице Модель устройства, NOT NULL |
| Код дома (в устройстве) | Ссылка на дом, к которому относится устройство | Целое и положительное | 11 | Внешний ключ к таблице Дом, NOT NULL |
| Код комнаты (в устройстве) | Ссылка на комнату, к которой относится устройство | Целое и положительное | 11 | Внешний ключ к таблице Комната, может быть NULL (опционально) |
| Название устройства | Название устройства заданное пользователем | Символьное значение | 100 | Пример: "Лампочка в спальне". Может быть NULL |
| Статус устройства | Состояние устройства | Символьное значение | - | "on" (включено), "off" (не включено), "unavailable" (недоступно). По умолчанию "off" |
| Статус режима энергосбережения | Статус режим энергосбережения для устройства | Логическое значение | - | TRUE (включено), FALSE (не включено). По умолчанию FALSE |
| Цвет | Оттенок цвета устройства (если поддерживается моделью) | Символьно-числовое значение | - | Определяется в capabilities модели устройства в формате JSON |
| Яркость | Интенсивность цвета устройства (если поддерживается моделью) | Числовое значение | - | Определяется в capabilities модели устройства в формате JSON. Диапазон зависит от модели |
| Дата и время добавления устройства | Дата и время добавления устройства | Дата и время | - | Формат: YYYY-MM-DD HH:MM:SS |
| Дата и время последнего контакта | Последний контакт с устройством | Дата и время | - | Формат: YYYY-MM-DD HH:MM:SS. Может быть NULL. Обновляется при каждом контакте |
| **Модель устройства** | Информация о типе и характеристиках устройства | Код модели устройства<br>+ Код типа устройства<br>+ Название модели<br>+ Возможности устройства |  |  |
| Код модели устройства | Уникальный код модели устройства | Целое и положительное | 11 | AUTO_INCREMENT, NOT NULL |
| Название модели устройства | Название модели устройства | Символьное значение | 100 | Уникальное в системе. Примеры: "Stets Bulb Pro", "Stets Socket Basic" |
| Код типа устройства | Уникальный код типа устройства | Символьное значение | - | Определяется полем device_type. Значения: "bulb" (лампочка), "socket" (розетка) |
| Возможности устройства | Возможности устройства в формате JSON | JSON | - | Пример: {"energy_saving": true, "brightness": true, "color": false}. Определяет поддерживает ли устройство энергосбережение, яркость, цвет |
| Описание модели | Описание модели устройства | Текстовое значение | - | Может быть NULL. Пример: "Умная лампочка с поддержкой энергосбережения" |
| **Тип устройства** | Справочник типов устройств | Код типа устройства<br>+ Тип устройства |  |  |
| Код типа устройства | Уникальный код типа устройства | Символьное значение | - | Определяется полем device_type в Модель устройства. Значения: "bulb", "socket" |
| Тип устройства | Информация о типе устройства (лампочка, розетка) | Символьное значение | - | "bulb" (лампочка), "socket" (розетка) |
| **Сценарий** | Сценарии заданные пользователем для автоматизации управления умным домом | Код сценария<br>+ Код дома<br>+ Название сценария<br>+ Тип запуска<br>+ Время запуска<br>+ Дни недели<br>+ Статус сценария |  |  |
| Код сценария | Синтетический первичный ключ кода сценария | Целое и положительное | 11 | AUTO_INCREMENT, NOT NULL |
| Код дома (в сценарии) | Ссылка на дом, к которому относится сценарий | Целое и положительное | 11 | Внешний ключ к таблице Дом, NOT NULL |
| Название сценария | Название сценария присвоенное пользователем | Символьное значение | 30 | Минимум 1 символ, максимум 30 символов. Уникальное в рамках дома. Пример: "Утренний свет" |
| Тип запуска | Тип запуска: ручной или автоматический | Символьное значение | - | Определяется наличием расписания. Если есть расписание в таблице День недели в сценарии, то автоматический, иначе ручной |
| Время запуска | Время начала сценария | Время ЧЧ:MM | - | Формат: HH:MM:SS (24-часовой формат). Определяется в таблице День недели в сценарии. Может быть NULL для ручных сценариев |
| Дни недели | Дни недели в которые должен срабатывать сценарий автоматизации | Символьное значение | - | Определяется в таблице День недели в сценарии через связь с таблицей День недели |
| Статус сценария | Состояние сценария | Символьное значение | - | "not_started" (не включен), "active" (включен), "completed" (завершен), "unavailable" (недоступен). Определяется логикой приложения |
| Дата и время создания сценария | Дата и время создания сценария | Дата и время | - | Формат: YYYY-MM-DD HH:MM:SS |
| Дата и время последнего обновления сценария | Дата и время последнего обновления сценария | Дата и время | - | Формат: YYYY-MM-DD HH:MM:SS |
| **Сценарий устройство** | Связывает сценарии с устройствами и действиями над ними | Код сценария<br>+ ID устройства<br>+ Статус устройства |  |  |
| Код действия | Синтетический первичный ключ действия сценария | Целое и положительное | 11 | AUTO_INCREMENT, NOT NULL |
| Код сценария (в действии) | Ссылка на сценарий | Целое и положительное | 11 | Внешний ключ к таблице Сценарий, NOT NULL |
| ID устройства (в действии) | Уникальный 12-значный код для идентификации устройства | Целое и положительное | 11 | Внешний ключ к таблице Устройство, NOT NULL |
| Статус устройства (в действии) | Состояние устройства, которое должно быть установлено действием | Символьное значение | - | "turn_on" (включить), "turn_off" (выключить) |
| Порядок выполнения | Порядок выполнения действия в сценарии | Целое и положительное | 11 | Минимум 1. Определяет последовательность выполнения действий |
| **День недели в сценарии** | Связывает сценарии с днями недели | Код сценария<br>+ Код дня недели<br>+ Код дома<br>+ Время начала<br>+ Время окончания |  |  |
| Код расписания | Синтетический первичный ключ расписания сценария | Целое и положительное | 11 | AUTO_INCREMENT, NOT NULL |
| Код сценария (в расписании) | Ссылка на сценарий | Целое и положительное | 11 | Внешний ключ к таблице Сценарий, NOT NULL |
| Понедельник | Выполнение сценария в понедельник | Логическое значение | - | TRUE (выполняется), FALSE (не выполняется). По умолчанию FALSE |
| Вторник | Выполнение сценария во вторник | Логическое значение | - | TRUE (выполняется), FALSE (не выполняется). По умолчанию FALSE |
| Среда | Выполнение сценария в среду | Логическое значение | - | TRUE (выполняется), FALSE (не выполняется). По умолчанию FALSE |
| Четверг | Выполнение сценария в четверг | Логическое значение | - | TRUE (выполняется), FALSE (не выполняется). По умолчанию FALSE |
| Пятница | Выполнение сценария в пятницу | Логическое значение | - | TRUE (выполняется), FALSE (не выполняется). По умолчанию FALSE |
| Суббота | Выполнение сценария в субботу | Логическое значение | - | TRUE (выполняется), FALSE (не выполняется). По умолчанию FALSE |
| Воскресенье | Выполнение сценария в воскресенье | Логическое значение | - | TRUE (выполняется), FALSE (не выполняется). По умолчанию FALSE |
| Время начала | Время начала выполнения сценария | Время ЧЧ:MM | - | Формат: HH:MM:SS. Может быть NULL. Пример: "07:00:00" |
| Время окончания | Время окончания выполнения сценария | Время ЧЧ:MM | - | Формат: HH:MM:SS. Может быть NULL. Пример: "08:00:00" |
| **День недели** | Справочник дней недели для запуска сценариев | Код дня недели<br>+ Название дня недели |  |  |
| Код дня недели | Синтетический первичный ключ дня недели | Целое и положительное | - | Определяется логически в приложении |
| Название дня недели | День недели для выбора запуска сценария | Символьное значение | 15 | Пн, Вт, Ср, Чт, Пт, Сб, Вс |

## Бизнес-правила и ограничения

### Ограничения количества

- Максимум 10 домов на пользователя (проверка в приложении)
- Максимум 10 комнат на дом (проверка в приложении)
- Максимум 100 устройств на дом (проверка в приложении)
- Максимум 10 сценариев на дом (проверка в приложении)

### Валидации

#### Валидация электронной почты
- Формат: должен содержать символ @
- Длина: 5-255 символов
- Уникальность в системе

#### Валидация пароля
- Длина: 8-16 символов
- Минимум 1 строчная буква латиницы (a-z)
- Минимум 1 прописная буква латиницы (A-Z)
- Может содержать цифры и специальные символы
- Хранится в виде bcrypt hash

#### Валидация ID устройства
- Формат: ровно 12 цифр (0-9)
- Уникальность в системе
- Примеры: "123456789012", "987654321098"

#### Валидация названия сценария
- Длина: 1-30 символов
- Может содержать буквы, цифры, пробелы, дефисы
- Уникальность в рамках дома
- Примеры: "Утренний свет", "Вечерний режим", "Выход из дома"

#### Валидация времени
- Формат: HH:MM:SS (24-часовой формат)
- Диапазон: 00:00:00 - 23:59:59
- Примеры: "07:00:00", "22:30:00", "00:15:30"

### Уникальные ограничения

- Один пользователь может быть в доме только один раз (уникальная комбинация Электронная почта + Код дома)
- Уникальное название комнаты в доме (уникальная комбинация Код дома + Название комнаты)
- Уникальное название сценария в доме (уникальная комбинация Код дома + Название сценария)
- Уникальный ID устройства в системе

### Правила целостности

- При удалении пользователя удаляются все его связи с домами (Доступ к дому)
- При удалении дома удаляются все комнаты, устройства и сценарии дома
- При удалении комнаты устройства остаются без привязки (Код комнаты становится NULL)
- При удалении сценария удаляются все его расписания (День недели в сценарии) и действия (Сценарий устройство)

