# Словарь данных (Data Dictionary) — русские обозначения

## Контекст

Словарь данных описывает атрибуты сущностей и типы данных, используемых в приложении Stets Home. Все обозначения приведены на русском языке для удобства продуктовой, аналитической и разработческой команд.

---

## Структура словаря

### Пользователь
| Элемент данных | Описание | Состав / тип | Длина | Значения / правила |
| --- | --- | --- | --- | --- |
| Пользователь | Композит сущности пользователя | Электронная почта (PK)<br>Имя пользователя<br>Пароль пользователя | — | — |
| Электронная почта | Адрес, указанный при регистрации (PK) | Символьно‑числовой | 255 | Содержит `@`, уникален в системе |
| Имя пользователя | Имя, указанное при регистрации | Символьный | 100 | Минимум 2 символа |
| Пароль пользователя | Пароль для аутентификации (хранится как bcrypt hash) | Символьно‑числовой | 60 | 8–16 символов, минимум 1 строчная и 1 прописная латинская буква |

### Дом
| Элемент данных | Описание | Состав / тип | Длина | Значения / правила |
| --- | --- | --- | --- | --- |
| Дом | Композит сущности дома | Код дома (PK)<br>Название дома | — | 1 пользователь = ≤10 домов |
| Код дома | Первичный ключ | Целое положительное | 11 | `AUTO_INCREMENT`, `NOT NULL` |
| Название дома | Название, заданное пользователем | Символьный | 100 | По умолчанию «Мой дом», уникально в рамках пользователя |

### Доступ к дому
| Элемент данных | Описание | Состав / тип | Длина | Значения / правила |
| --- | --- | --- | --- | --- |
| Доступ к дому | Связь пользователь ↔ дом | Электронная почта (PK, FK)<br>Код дома (PK, FK)<br>Уровень доступа | — | — |
| Электронная почта | FK → Пользователь | Символьно‑числовой | 255 | `NOT NULL` |
| Код дома | FK → Дом | Целое положительное | 11 | `NOT NULL` |
| Уровень доступа | Роль пользователя в доме | Символьный | — | `owner`, `member` (по умолчанию `member`) |

### Комната
| Элемент данных | Описание | Состав / тип | Длина | Значения / правила |
| --- | --- | --- | --- | --- |
| Комната | Помещение внутри дома | Код комнаты<br>Код типа комнаты<br>Название комнаты | — | Дом содержит ≤10 комнат |
| Код комнаты | Первичный ключ | Целое положительное | 11 | `AUTO_INCREMENT`, `NOT NULL` |
| Код типа комнаты | FK → Тип комнаты | Символьный | 50 | Ссылка на справочник `Тип комнаты` |
| Название комнаты | Название помещения | Символьно‑числовой | 100 | Минимум 1 символ, уникально в рамках дома |
| Дата создания | Дата добавления комнаты | `DATETIME` | — | Формат `YYYY-MM-DD HH:MM:SS` |

### Тип комнаты (справочник)
| Элемент данных | Описание | Состав / тип | Длина | Значения / правила |
| --- | --- | --- | --- | --- |
| Тип комнаты | Справочник доступных типов | Код типа комнаты (PK)<br>Название типа<br>Иллюстрация | — | — |
| Код типа комнаты | Первичный ключ справочника | Символьный | 50 | Например, `bedroom`, `kitchen`, `bathroom`; уникально |
| Название типа | Имя типа | Символьный | 50 | Человекочитаемое значение |
| Иллюстрация | Иконка/изображение | URL | 255 | Валидный URL, напр. `/icons/bedroom.svg` |

### Устройство
| Элемент данных | Описание | Состав / тип | Длина | Значения / правила |
| --- | --- | --- | --- | --- |
| Устройство | Смарт-устройство пользователя | ID устройства<br>Код типа устройства<br>Название<br>Статусы | — | Дом содержит ≤100 устройств |
| ID устройства | Первичный ключ | Числовой | 12 | Только цифры, уникальный в системе |
| Код типа устройства | FK → Тип устройства | Символьный | 50 | `bulb`, `socket` |
| Название устройства | Пользовательское имя | Символьный | 100 | Может быть `NULL`; пример «Лампочка в спальне» |
| Статус устройства | Состояние | Символьный | — | `on`, `off`, `unavailable` (по умолчанию `off`) |
| Энергосбережение | Флаг режима энергосбережения | Логический | — | `TRUE`/`FALSE`, по умолчанию `FALSE` |
| Цвет | Цвет (если поддерживается) | JSON / строка | — | Определяется типом устройства |
| Яркость | Яркость (если поддерживается) | Числовой | — | Диапазон задаётся типом устройства |
| Дата добавления | Дата привязки устройства | `DATETIME` | — | Формат `YYYY-MM-DD HH:MM:SS` |
| Последний контакт | Последнее событие связи | `DATETIME` | — | Может быть `NULL`; обновляется при каждом контакте |

### Тип устройства (справочник)
| Элемент данных | Описание | Состав / тип | Длина | Значения / правила |
| --- | --- | --- | --- | --- |
| Тип устройства | Справочник доступных типов устройств | Код типа устройства<br>Название типа<br>Описание/иконка | — | — |
| Код типа устройства | Первичный ключ справочника | Символьный | 50 | Например, `bulb`, `socket`; уникально |
| Название типа | Человекочитаемое название | Символьный | 50 | «Лампочка», «Розетка» |

### Сценарий
| Элемент данных | Описание | Состав / тип | Длина | Значения / правила |
| --- | --- | --- | --- | --- |
| Сценарий | Автоматизация пользователя | Код сценария<br>Название<br>Статус | — | Дом содержит ≤10 сценариев |
| Код сценария | Первичный ключ | Целое положительное | 11 | `AUTO_INCREMENT`, `NOT NULL` |
| Название сценария | Название, заданное пользователем | Символьный | 30 | 1–30 символов, уникально в рамках дома |
| Тип запуска | Способ запуска | Символьный | — | Ручной или автоматический (на основе расписания) |
| Время запуска | Начало сценария | `TIME` | — | Формат `HH:MM:SS`, может быть `NULL` |
| Дни недели | Дни автоматического запуска | Символьный / список | — | Определяется через расписание |
| Статус сценария | Состояние | Символьный | — | `not_started`, `active`, `completed`, `unavailable` |
| Дата создания | Дата создания сценария | `DATETIME` | — | Формат `YYYY-MM-DD HH:MM:SS` |
| Дата обновления | Последнее изменение сценария | `DATETIME` | — | Формат `YYYY-MM-DD HH:MM:SS` |

### Действие сценария (Scenario Action)
| Элемент данных | Описание | Состав / тип | Длина | Значения / правила |
| --- | --- | --- | --- | --- |
| Действие сценария | Связь сценарий ↔ устройство | Код сценария (PK, FK)<br>ID устройства (PK, FK)<br>Действие | — | — |
| Код сценария | FK → Сценарий | Целое положительное | 11 | `NOT NULL` |
| ID устройства | FK → Устройство | Числовой | 12 | 12 цифр, `NOT NULL` |
| Тип действия | Что сделать с устройством | Символьный | — | `turn_on`, `turn_off` |

### Расписание сценария (Scenario Schedule)
| Элемент данных | Описание | Тип | Длина | Значения / правила |
| --- | --- | --- | --- | --- |
| Код сценария | PK, FK → Сценарий | Целое положительное | 11 | `NOT NULL` |
| Код дня недели | PK, FK → День недели | Целое положительное | — | `NOT NULL` |
| Время начала | Старт выполнения | `TIME` | — | Формат `HH:MM:SS`, может быть `NULL` |
| Время окончания | Завершение | `TIME` | — | Формат `HH:MM:SS`, может быть `NULL` |

### День недели (справочник)
| Элемент данных | Описание | Тип | Длина | Значения |
| --- | --- | --- | --- | --- |
| Код дня недели | Первичный ключ | Целое положительное | — | 1–7 (логически определяется приложением) |
| Название дня недели | Человекочитаемое обозначение | Символьный | 15 | `Пн`, `Вт`, `Ср`, `Чт`, `Пт`, `Сб`, `Вс` |

---

## Бизнес-правила и ограничения

### Количественные ограничения
- До 10 домов на пользователя
- До 10 комнат и 10 сценариев на дом
- До 100 устройств на дом

### Валидации
- **Электронная почта:** 5–255 символов, содержит `@`, уникальна
- **Пароль:** 8–16 символов, минимум одна строчная и одна прописная латинская буква, хранится в виде bcrypt hash
- **ID устройства:** ровно 12 цифр, уникален в системе
- **Название сценария:** 1–30 символов, уникально в рамках дома
- **Время:** формат `HH:MM:SS`, диапазон `00:00:00`–`23:59:59`

### Уникальные ограничения
- Пользователь ↔ дом: пара (пользователь, дом) уникальна
- Название комнаты уникально в пределах дома
- Название сценария уникально в пределах дома
- ID устройства уникален глобально

### Правила целостности
- Удаление пользователя удаляет связанные записи в «Доступ к дому»
- Удаление дома приводит к удалению всех комнат, устройств и сценариев дома
- Удаление комнаты оставляет связанные устройства без привязки (`room_id = NULL`)
- Удаление сценария удаляет его расписания и действия

