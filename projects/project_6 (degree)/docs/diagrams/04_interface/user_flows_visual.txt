╔════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                        User Flows - Stets Home (Пользовательские потоки)                                                       ║
╚════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝

════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

╔═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                           ПОТОК 1: Первый запуск и регистрация                                                                 ║
╚═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝

┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Первый    │───▶│   Splash    │───▶│ Onboarding  │───▶│ Регистрация │───▶│ Dashboard   │
│   запуск    │    │   Screen    │    │             │    │             │    │ (пустой)    │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘

Цель: Новый пользователь регистрируется и попадает в пустой дом

Шаги:
  1. Splash Screen      - загрузка приложения
  2. Onboarding        - знакомство с функциями
  3. Регистрация        - email, пароль, имя
  4. Dashboard (пустой) - автосоздание дома "Мой дом"

Критерии успеха:
  ✅ Время онбординга < 5 минут
  ✅ Автоматическое создание дома "Мой дом"
  ✅ Пользователь становится владельцем

════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

╔═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                           ПОТОК 2: Добавление устройства                                                                       ║
╚═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝

┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│ Добавление  │───▶│ Add Device  │───▶│   Выбор     │
│ устройства  │    │  Screen     │    │  метода     │
└─────────────┘    └─────────────┘    └──────┬──────┘
                                              │
                            ┌─────────────────┴─────────────────┐
                            │                                   │
                            ▼                                   ▼
                   ┌─────────────┐                    ┌─────────────┐
                   │  QR Scanner │                    │   Ручной    │
                   │             │                    │    ввод     │
                   └──────┬──────┘                    └──────┬──────┘
                          │                                   │
                          └─────────────────┬─────────────────┘
                                            ▼
                                   ┌─────────────┐
                                   │ Устройство  │
                                   │  найдено?   │
                                   └──────┬──────┘
                                          │
                           ┌──────────────┴──────────────┐
                           │                             │
                           ▼ (Да)                        ▼ (Нет)
                   ┌─────────────┐              ┌─────────────┐
                   │  Дубликат?  │              │    Ошибка   │
                   └──────┬──────┘              └─────────────┘
                          │
           ┌──────────────┴──────────────┐
           │                             │
           ▼ (Нет дубликата)             ▼ (Дубликат)
   ┌─────────────┐              ┌─────────────┐
   │   Выбор     │              │    Ошибка   │
   │  комнаты    │              └─────────────┘
   └──────┬──────┘
          │
          ▼
   ┌─────────────┐
   │ Устройство  │
   │  добавлено  │
   └─────────────┘

Decision Points:
  ⚠️ Выбор метода: QR vs ручной ввод
  ⚠️ Устройство найдено: Да/Нет
  ⚠️ Дубликат: Да/Нет

Метрики:
  ✅ Успешность QR > 95%
  ✅ Успешность ручного ввода > 90%
  ✅ Предотвращение дубликатов 100%

════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

╔═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                           ПОТОК 3: Создание сценария                                                                           ║
╚═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝

┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│ Создание    │───▶│  Scenarios  │───▶│   Create    │───▶│ Шаг 1:      │
│ сценария    │    │  Screen     │    │  Scenario   │    │ Название    │
└─────────────┘    └─────────────┘    └─────────────┘    └──────┬──────┘
                                                                  │
                     ┌────────────────────────────────────────────┴────────────┐
                     │                                                         │
                     ▼                                                         ▼
            ┌─────────────┐                                          ┌─────────────┐
            │ Шаг 2:      │                                          │ Шаг 3:      │
            │ Устройства  │                                          │ Действия    │
            └──────┬──────┘                                          └──────┬──────┘
                   │                                                         │
                   ▼                                                         ▼
            ┌─────────────┐                                          ┌─────────────┐
            │ Шаг 4:      │                                          │ Расписание? │
            │ Расписание  │                                          └──────┬──────┘
            └──────┬──────┘                                                 │
                   │                                                         │
                   ▼                                    ┌────────────────────┴────────────────────┐
            ┌─────────────┐                            │                                        │
            │ Шаг 5:      │                            ▼ (Да)                                   ▼ (Нет)
            │ Подтвер-    │                    ┌─────────────┐                         ┌─────────────┐
            │ ждение      │                    │ Шаг 5:      │                         │ Шаг 5:      │
            └──────┬──────┘                    │ Подтвер-    │                         │ Подтвер-    │
                   │                           │ ждение      │                         │ ждение      │
           ┌───────┴───────┐                   └──────┬──────┘                         └──────┬──────┘
           │               │                           │                                    │
           ▼               ▼                           │                                    │
   ┌─────────────┐ ┌─────────────┐                   └────────────────┬───────────────────┘
   │ Сценарий    │ │   Лимит     │                                   │
   │ создан      │ │ достигнут   │                                   │
   └─────────────┘ └─────────────┘                                   │
                                                                ┌───────┴───────┐
                                                                │               │
                                                                ▼               ▼
                                                        ┌─────────────┐ ┌─────────────┐
                                                        │ Сценарий    │ │   Лимит     │
                                                        │ создан      │ │ достигнут   │
                                                        └─────────────┘ └─────────────┘

Decision Points:
  ⚠️ Расписание: Да/Нет (ручной vs автоматический)
  ⚠️ Лимит сценариев: Достигнут/Нет (максимум 10)

Метрики:
  ✅ Завершение создания > 80%
  ✅ Использование расписания > 60%

════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

╔═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                           ПОТОК 4: Управление устройством                                                                      ║
╚═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝

┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│ Управление  │───▶│ Dashboard   │───▶│   Device    │───▶│   Действие  │
│ устройством │    │             │    │    Card     │    │             │
└─────────────┘    └─────────────┘    └──────┬──────┘    └──────┬──────┘
                                              │                  │
                                              ▼                  │
                                     ┌─────────────┐            │
                                     │   Device    │            │
                                     │  Control    │            │
                                     └──────┬──────┘            │
                                            │                   │
                            ┌───────────────┴───────────────┐  │
                            │                               │  │
                            ▼                               ▼  │
                   ┌─────────────┐                ┌─────────────┐
                   │   Включить/ │                │ Энерго-     │
                   │  выключить  │                │ сбережение  │
                   └──────┬──────┘                └──────┬──────┘
                          │                               │
          ┌────────────────┴─────────────────┐           │
          │                                  │           │
          ▼                                  ▼           │
  ┌─────────────┐                  ┌─────────────┐      │
  │ Устройство  │                  │ Устройство  │      │
  │ доступно?   │                  │ доступно?   │      │
  └──────┬──────┘                  └──────┬──────┘      │
         │                                 │             │
  ┌──────┴──────┐                  ┌──────┴──────┐      │
  │             │                  │             │      │
  ▼ (Да)        ▼ (Нет)            ▼ (Да)        ▼ (Нет)│
  ┌─────────────┐  ┌─────────────┐ ┌─────────────┐  ┌──┴─────────┐
  │ Команда     │  │ Устройство  │ │ Команда     │  │ Устройство │
  │ выполнена   │  │ недоступно  │ │ выполнена   │  │ недоступно │
  └─────────────┘  └──────┬──────┘ └─────────────┘  └──────┬──────┘
                          │                                │
                          ▼                                │
                   ┌─────────────┐                        │
                   │ Попробовать │◀────────────────────────┘
                   │   снова     │
                   └─────────────┘

Decision Points:
  ⚠️ Действие: Включить/выключить vs Энергосбережение
  ⚠️ Статус: Доступно/Недоступно

Метрики:
  ✅ Время отклика < 2 секунды
  ✅ Успешность команд > 98%

════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

╔═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                           ПОТОК 5: Добавление члена семьи                                                                      ║
╚═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝

┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│ Добавление  │───▶│  Settings   │───▶│ Home        │───▶│ Manage      │
│ члена       │    │             │    │ Settings    │    │ Members     │
│ семьи       │    └─────────────┘    └─────────────┘    └──────┬──────┘
└─────────────┘                                                  │
                                                                  ▼
                                                        ┌─────────────┐
                                                        │ Пригласить  │
                                                        │ участника   │
                                                        └──────┬──────┘
                                                               │
                                                               ▼
                                                        ┌─────────────┐
                                                        │  Ввод email │
                                                        └──────┬──────┘
                                                               │
                                                               ▼
                                                        ┌─────────────┐
                                                        │   Выбор     │
                                                        │    роли     │
                                                        └──────┬──────┘
                                                               │
                                                               ▼
                                                        ┌─────────────┐
                                                        │  Приглашение│
                                                        │  отправлено │
                                                        └──────┬──────┘
                                                               │
                                                               ▼
                                                        ┌─────────────┐
                                                        │  Участник   │
                                                        │  принял     │
                                                        └──────┬──────┘
                                                               │
                                                               ▼
                                                        ┌─────────────┐
                                                        │  Доступ     │
                                                        │ предоставлен│
                                                        └─────────────┘

Критерии успеха:
  ✅ Приглашение отправлено на email
  ✅ Участник может войти в дом
  ✅ Роль корректно назначена

Метрики:
  ✅ Успешность приглашения > 90%
  ✅ Принятие приглашения > 70%

════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
                                                    EDGE CASES
════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

СЕТЕВЫЕ ОШИБКИ:
════════════════

• Отсутствие интернета  → Кнопка "Попробовать снова"
• Таймаут запроса       → Автоматическая повторная попытка

ОШИБКИ ВАЛИДАЦИИ:
═════════════════

• Невалидный email      → Inline сообщение об ошибке
• Слабый пароль         → Требования к паролю
• Дубликат устройства   → Предупреждение

ОГРАНИЧЕНИЯ СИСТЕМЫ:
══════════════════════

• Превышение лимитов    → Информативные сообщения
• Недоступность устройства → Статус "недоступно"

════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════

                                                          [Конец user flows]
