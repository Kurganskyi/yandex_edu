# Задания по операторам LEFT OUTER JOIN и RIGHT OUTER JOIN

## Задание 1

Выведите названия всех треков, добавив информацию о датах, в которые эти треки покупали. Ни один трек не должен потеряться, даже если его не покупали вообще. Чтобы получить нужный результат, надо соединить три таблицы сразу, ведь таблица `invoice`, которая хранит данные о дате заказа, не содержит информации о купленных треках.

Сначала соедините таблицы `track` и `invoice_line` по ключу `track_id`, а затем присоедините таблицу `invoice` по ключу `invoice_id`. В итоговую таблицу поместите два поля: `name` из таблицы `track` и `invoice_date` из таблицы `invoice`. Приведите столбец с датами к типу `date`.

### Решение

```sql
SELECT
    t.name AS track_name,
    CAST(i.invoice_date AS DATE) AS invoice_date
FROM
    track AS t
LEFT JOIN
    invoice_line AS il ON t.track_id = il.track_id
LEFT JOIN
    invoice AS i ON il.invoice_id = i.invoice_id;
```

---

## Задание 2

Для каждого года, выраженного числом, посчитайте уникальные названия купленных треков.

### Решение

```sql
SELECT
    EXTRACT(YEAR FROM i.invoice_date)::INT AS year,
    COUNT(DISTINCT t.name) AS unique_track_names
FROM
    invoice_line AS il
INNER JOIN
    invoice AS i ON il.invoice_id = i.invoice_id
INNER JOIN
    track AS t ON il.track_id = t.track_id
GROUP BY
    EXTRACT(YEAR FROM i.invoice_date)
ORDER BY
    year;
```

---