# Анализ архитектуры стримингового сервиса Otium

## Описание системы

**Otium** — онлайн-кинотеатр с обширной библиотекой фильмов и сериалов, предоставляющий доступ через:
- Веб-приложение
- Приложение для ПК
- Мобильное приложение
- Приложение для смарт-ТВ

## Функциональность системы

### Основные возможности:
1. **Авторизация** в системе
2. **Библиотека контента** - просмотр и фильтрация фильмов/сериалов по типу и жанрам
3. **Детальная информация** о каждом фильме/сериале
4. **Эксклюзивный контент** - фильмы/сериалы, доступные только в Otium

## Архитектура системы

### Микросервисная архитектура

Система построена на микросервисной архитектуре с 5 основными сервисами:

#### Операционные микросервисы:
- **Пользователь** (`<<service>>`) - управление пользователями и профилями
- **Подписка** (`<<service>>`) - управление подписками
- **Оплата** (`<<service>>`) - обработка платежей

#### Контентные микросервисы:
- **Фильмы** (`<<service>>`) - каталог фильмов
- **Сериалы** (`<<service>>`) - каталог сериалов

### Слой API

Все запросы проходят через **слой API**, который содержит бизнес-логику доступа к микросервисам.

### Пример взаимодействия

**Сценарий:** Пользователь проверяет свою подписку

1. Пользователь открывает профиль в интерфейсе
2. Запрос поступает в слой API
3. API направляет запрос в микросервис "Пользователи"
4. Микросервис возвращает информацию о подписке (например, Basic)
5. API передает данные в интерфейс
6. Пользователь видит информацию о подписке

## Компоненты для доступа к контенту

Для получения информации о фильмах и сериалах **без авторизации** взаимодействуют:

1. **UI: Otium** - пользовательский интерфейс
2. **Web Server** - веб-сервер
3. **Films Server** - сервис фильмов
4. **Series Server** - сервис сериалов

## Диаграмма последовательности

### Сценарий: Запрос списка всех фильмов и сериалов

```
UI: Otium → Web Server → Films Server
                    → Series Server
```

**Параллельное выполнение:**
- Запрос списка фильмов
- Запрос списка сериалов

**Оператор фрейма:** `par` (параллельное выполнение)

## API сервисов

### Стиль API
- **SOAP** - все три сервиса используют SOAP
- **XML** - формат представления данных

### Структура ответов
- Теги с атрибутами: `<content type="film" id="101">`
- Булевый атрибут `exclusive`: `true`/`false`

### Операции API

#### Web Server API
- `{{WebServer}}/content/list` - получение списка контента
- `{{WebServer}}/content/details` - детальная информация

#### Films Server API  
- `{{FilmsServer}}/films/list` - список фильмов
- Содержит атрибут `exclusive`

#### Series Server API
- `{{SeriesServer}}/series/list` - список сериалов  
- Содержит атрибут `exclusive`

## Требуемые изменения

### Проблема
API не позволяет фильтровать список по признаку эксклюзивности.

### Решение
Доработать операцию `{{WebServer}}/content/list` для поддержки фильтрации по `exclusive`.

### Необходимые изменения:
1. Добавить параметр фильтрации в запрос
2. Обработать фильтрацию на уровне Web Server
3. Передать отфильтрованные данные в интерфейс
